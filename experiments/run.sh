#!/bin/bash
set -e
DOMAIN=$1
EXPDIR=$2
ALGORITHM=$3
MODE=$4

DIR=/home/mohammed/drake-tamp/
PROBLEM_FILE_PATH=$DIR/experiments/$DOMAIN/problems/autogenerated
export CUDA_VISIBLE_DEVICES=""
mkdir -p $EXPDIR && cd $EXPDIR

for FILE in $(ls $PROBLEM_FILE_PATH/5*); do
  echo "Running $FILE"
  timeout --signal 9 --foreground 90s python -O $DIR/experiments/main.py --eager-mode --domain=$DOMAIN --algorithm $ALGORITHM --mode $MODE --domain-options='{"problem_file": "'$FILE'"}' | tee ./$(basename $FILE).log
done